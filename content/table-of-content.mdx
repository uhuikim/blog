---
title: Next.jsì™€ MDXë¥¼ í™œìš©í•œ ë¸”ë¡œê·¸ -  ëª©ì°¨ ì»´í¬ë„ŒíŠ¸(TOC) ë§Œë“¤ê¸°
abstract: í¬ìŠ¤íŠ¸ ë‚´ìš©ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ì–´ìš”. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ activeê°€ ë˜ê³ , ë§í¬ í´ë¦­ì‹œ í•´ë‹¹ ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤ ì‹œì¼œì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.
publishedOn: '2023.10.12'
tags: ['Next.js']
time: '5min'
---

ì´ë²ˆì— Next.js 13ë²„ì „ê³¼ MDXë¥¼ í™œìš©í•˜ì—¬ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤.

ë ˆí¼ëŸ°ìŠ¤ ì¡°ì‚¬ë¥¼ í•˜ë©´ì„œ ì—¬ëŸ¬ ë¸”ë¡œê·¸ë¥¼ ë³´ì•˜ëŠ”ë°ìš”, ì‚¬ì´ë“œì— ëª©ì°¨ë¥¼ ë³´ì—¬ì£¼ëŠ”ê²Œ ê°€ë…ì„±ì— ë” ì¢‹ë‹¤ëŠ” ìƒê°ì´ ë“¤ë”ë¼ê³ ìš”!í•´ì„œ ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì•˜ìŠµë‹ˆë‹¤!ğŸ˜†

mdxë¥¼ í™œìš©í•˜ëŠ”ê±´ ì²˜ìŒì´ë¼ì„œ ì¡°ê¸ˆ í—¤ë§¸ëŠ”ë°!!ì œê°€ ë§Œë“  ë°©ë²•ì„ í•œë²ˆ ê³µìœ í•´ë³¼ê²Œìš”!!

ì•„ ì°¸ê³ ë¡œ ì œë¡œë² ì´ìŠ¤ì—ì„œ [ê¸°ìˆ  ë¸”ë¡œê·¸ ì •ë¦¬](https://zero-base.co.kr/event/media_insight_contents_FE_frontend_blog)ë¥¼ ì˜í•´ë†¨ë”ë¼ê³ ìš”~

ë¸”ë¡œê·¸ ë§Œë“¤ ë•Œ ì°¸ê³ í•´ë³´ì„¸ìš”!!

---

## hash linkë¡œ ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¤ê¸°

ëª©ì°¨ë¥¼ í´ë¦­í–ˆì„ ë•Œ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™ì‹œì¼œì£¼ê¸° ìœ„í•´ì„œ `hash link`ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

mdxë¡œ ì‘ì„±ëœ ë¬¸ì„œì— ì–´ë–»ê²Œ hashë§í¬ë¥¼ ë„£ì–´ì•¼í•˜ì§€ ê³ ë¯¼ì„ í•˜ë©°...ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ì„ ì°¾ì•„ë´¤ì—ˆëŠ”ë°ã…ã…
mdx íŒŒì¼ì„ htmlë¡œ ë³€í™˜í• ë•Œ ì‚¬ìš©í•œ `next-mdx-remote`ë¥¼ ì´ìš©í•˜ì—¬, custom ì»´í¬ë„ŒíŠ¸ë¡œ ë³€í™˜ì‹œì¼œì£¼ë©´ ë˜ë”ë¼ê³ ìš”!

[mdx headingì— anchorë„£ê¸°](https://tomekdev.com/posts/anchors-for-headings-in-mdx)

### ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

```jsx
import Link from 'next/link';

import styles from './H2.module.scss';

// ìˆ«ì,í•œê¸€ ë“±ì„ ì œì™¸í•œ ê¸€ì”¨ë¥¼ ì œê±°í•˜ê³  ê³µë°±ì„ -ìœ¼ë¡œ ë³€ê²½í•¨
const getAnchor = (text) => {
    return text
        .toLowerCase()
        .replace(/[^a-z0-9ã„±-ã…£ê°€-í£ ]/g, '')
        .replace(/[ ]/g, '-');
};

const H2 = ({ children }) => {
    const anchor = getAnchor(children);
    const link = `#${anchor}`;

    return (
        <h2 id={anchor} className={styles.h2}>
            <Link href={link} className={styles.anchor}>
                Â§
            </Link>
            {children}
        </h2>
    );
};
export default H2;
```

ìš°ì„  hash ë§í¬ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ getAnchorë€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
ìˆ«ì, í•œê¸€, ì˜ë¬¸ìë¥¼ ì œì™¸í•œ ê¸€ì”¨ëŠ” ì œê±°í•˜ê³ , ê³µë°±ì€ - ë¡œ ì—°ê²°í•˜ì—¬ ë§Œë“¤ì—ˆì–´ìš”.

ì´ë¥¼ h2íƒœê·¸ì˜ idê°’ê³¼ Linkíƒœê·¸ì˜ hrefê°’ì— ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

### ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸ë¡œ ë³€í™˜í•˜ê¸°

```jsx
import { MDXRemote } from 'next-mdx-remote/rsc';

async function BlogPost({ params }) {
    return (
        <MDXRemote
            source={content}
            components={{
                h2: H2,
                h3: H3
            }}
        />
    );
}

export default BlogPost;
```

ê·¸ ë‹¤ìŒ ìœ„ì—ì„œ ë§Œë“  ì»´í¬ë„ŒíŠ¸ë¡œ h2, h3íƒœê·¸ë¥¼ ë³€ê²½í•´ì¤ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì§œì”!ğŸ‰ ì´ë ‡ê²Œ ë§í¬ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤.

<video
    autoPlay
    loop
    muted
    playsInline

>

    <source
        src="https://github.com/uhuikim/blog-source/blob/main/table-of-content/hash-link.webm?raw=true"
        type="video/webm"
    />
    <source
        src="https://github.com/uhuikim/blog-source/blob/main/table-of-content/hash-link.mp4?raw=true"
        type="video/mp4"
    />

</video>

ì—¬ê¸°ì„œ ì ê¹ğŸ¦„

ìŠ¤í¬ë¡¤í–ˆì„ë•Œ ìœ„ì— ìƒë‹¨ê³¼ ì—¬ë°±ì—†ì´ ë”± ë¶™ê²Œ ë˜ëŠ”ë°ìš”!

> css ì†ì„± `scroll-margin-top` ì„ ì‚¬ìš©í•˜ë©´ ìƒë‹¨ ê°„ê²©ì„ ë„ìš¸ìˆ˜ ìˆë‹µë‹ˆë‹¤.

## mdxì—ì„œ Heading ì¶”ì¶œí•˜ê¸°

ê·¸ ë‹¤ìŒìœ¼ë¡œëŠ” mdxë¬¸ì„œì—ì„œ heading ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•´ë³¼ê²Œìš”

[ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°](https://www.freecodecamp.org/news/how-to-build-a-table-of-contents-component/)
ğŸ‘ˆ ì €ëŠ” ì´ê¸€ì„ ë³´ê³  ë”°ë¼í–ˆëŠ”ë°ìš”!
[ì½”ë“œ](https://github.com/kaf-lamed-beyt/extract-md-headings/blob/master/src/index.ts)ê°€ ê¹ƒí—ˆë¸Œì— ì½”ë“œê°€ ê³µê°œë˜ì–´ìˆì–´ì„œ ì´ ì½”ë“œë¥¼ ì‚¬ìš©í–ˆì–´ìš”ã…ã…

```js
import matter from 'gray-matter';

export const loadBlogPost = async function loadBlogPost(slug) {
    let rawContent;
    const headings = [];
    const headingMatcher = /^(#+)\s(.+)$/gm;

    // mdxíŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì½”ë“œ
    try {
        rawContent = await readFile(`/content/${slug}.mdx`);
    } catch (err) {
        return null;
    }

    // contentë¥¼ ì¶”ì¶œí•¨
    const { data: frontmatter, content } = matter(rawContent);

    // #ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” Headingì„ ì¶”ì¶œí•¨
    let match = headingMatcher.exec(content);
    while (match !== null) {
        const level = match[1].length;
        const title = match[2].trim();
        const name = getAnchor(title);

        headings.push({ name, title, level });
        match = headingMatcher.exec(content);
    }
    return { frontmatter, content, headings };
};
```

ì´ë ‡ê²Œ í—¤ë”©ì„ ì¶”ì¶œí•˜ì˜€ë‹µë‹ˆë‹¤!

```js
//result
[
    {
        name: 'hash-linkë¡œ-ì›í•˜ëŠ”-ìœ„ì¹˜ë¡œ-ì´ë™ì‹œí‚¤ê¸°',
        title: 'hash linkë¡œ ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¤ê¸°',
        level: 2
    },
    {
        name: 'ì»¤ìŠ¤í…€-ì»´í¬ë„ŒíŠ¸-ë§Œë“¤ê¸°',
        title: 'ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°',
        level: 3
    }
];
```

ê²°ê³¼ë¬¼ì€ ì´ë ‡ê²Œ ë‚˜ì™€ìš”!

## ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

ì ê·¸ëŸ¼ ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤!

```jsx
'use client';

import React, { useEffect } from 'react';

import clsx from 'clsx';
import Link from 'next/link';

import styles from './TableOfContents.module.scss';

function TableOfContents({ headings }) {
    // acrive ìƒíƒœ ê´€ë¦¬
    const [active, setActive] = React.useState(
        headings.length > 0 ? headings[0].name : ''
    );

    const isElementInViewport = (el) => {
        const rect = el.getBoundingClientRect();
        return (
            rect.top >= 0 &&
            rect.left >= 0 &&
            rect.bottom <=
                (window.innerHeight || document.documentElement.clientHeight) &&
            rect.right <= (window.innerWidth || document.documentElement.clientWidth)
        );
    };
    useEffect(() => {
        const handleScroll = () => {
            const headingElements = headings.map(({ name }) =>
                document.getElementById(name)
            );

            const visibleHeadings = headingElements.filter((el) =>
                isElementInViewport(el)
            );
            if (visibleHeadings.length > 0) {
                setActive(visibleHeadings[0].id);
            }
        };

        document.addEventListener('scroll', handleScroll);
        return () => {
            document.removeEventListener('scroll', handleScroll);
        };
    }, [headings]);

    return (
        <aside className={styles.wrap}>
            <div className={styles.container}>
                <nav className={styles.nav}>
                    <h2>TABLE OF CONTENTS</h2>
                    {headings.map(({ name, title, level }) => (
                        <Link
                            onClick={() => setActive(name)}
                            key={name}
                            href={`#${name}`}
                            className={clsx(styles[`depth${level - 1}`], {
                                [styles.active]: active === name
                            })}
                        >
                            {title}
                        </Link>
                    ))}
                </nav>
            </div>
        </aside>
    );
}

export default TableOfContents;
```

-   ì¶”ì¶œí•œ heading ë¦¬ìŠ¤íŠ¸ë¥¼ mapì„ ëŒë ¤ì¤ë‹ˆë‹¤.
-   ìœ„ì—ì„œì™€ ë™ì¼í•˜ê²Œ Linkíƒœê·¸ì— hashë§í¬ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
-   activeë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ stateë¥¼ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.
-   getBoundingClientRectë¥¼ í™œìš©í•˜ì—¬ í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì—ì„œ ë³´ì—¬ì§€ëŠ” í—¤ë”©ì„ activeì‹œì¼œì¤ë‹ˆë‹¤.
-   activeê°’ì„ í™œìš©í•˜ì—¬ ìŠ¤íƒ€ì¼ë§ì„ í•´ì¤ë‹ˆë‹¤.

ì´ ë˜í•œ ìœ„ì—ì„œ ê³µìœ í•œ ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤!

ëºŒ!!ê·¸ëŸ¼ ìš”ë ‡ê²Œ ìŠ¤í¬ë¡¤ì— ë”°ë¼ ìƒ‰ì´ ì˜ ë³€í•©ë‹ˆë‹¤!!
ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë§í¬ í´ë¦­ì„ í•´ë„ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì˜ ì´ë™í•˜ë„¤ìš”!

<video
    autoPlay
    loop
    muted
    playsInline

>

    <source
        src="https://github.com/uhuikim/blog-source/blob/main/table-of-content/active.webm?raw=true"
        type="video/webm"
    />
    <source
        src="https://github.com/uhuikim/blog-source/blob/main/table-of-content/active.mp4?raw=true"
        type="video/mp4"
    />

</video>

ì‚¬ì‹¤ ì²˜ìŒë§Œë“¤ ë•Œ ëª©ì°¨ë¥¼ í´ë¦­í•´ë„ í•´ë‹¹ ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤ì´ ë˜ì§€ ì•Šì•„ì„œ
[HashScroll](https://github.com/vercel/next.js/issues/44625#issuecomment-1405018008) ì´ ë°©ë²•ìœ¼ë¡œ layoutì—ì„œ ê°ì‹¸ì¤¬ì—ˆëŠ”ë°,
ì„¸ìƒì—!! Linkì— scroll={'false'} ê°’ì„ ë¹¼ì£¼ë‹ˆê¹Œ ì‘ë™ì„ í•˜ë„¤ìš”...ã…ã…ã…ã…

ë„¤! ì´ë ‡ê²Œ ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì•˜ìŠµë‹ˆë‹¤.
í•˜ë‚˜ì”© í•˜ë‚˜ì”© ë§Œë“¤ì–´ê°€ë©´ì„œ ,ë˜ ê³µìœ í•´ë³´ê² ìŠµë‹ˆë‹¤!

ê·¸ëŸ¼ ì´ë§Œ~~

## ì°¸ê³ 

[ê°œë°œì ë¸”ë¡œê·¸ ëª¨ìŒì§‘](https://zero-base.co.kr/event/media_insight_contents_FE_frontend_blog)
[mdx headingì— anchorë„£ê¸°](https://tomekdev.com/posts/anchors-for-headings-in-mdx)
[ëª©ì°¨ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°](https://www.freecodecamp.org/news/how-to-build-a-table-of-contents-component/)
[headingì¶”ì¶œ ì½”ë“œ](https://github.com/kaf-lamed-beyt/extract-md-headings/blob/master/src/index.ts)
[HashScroll](https://github.com/vercel/next.js/issues/44625#issuecomment-1405018008)
